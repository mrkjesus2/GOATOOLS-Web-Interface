{% extends 'goatoolsgui/base.html' %}

{% load static %}

{% block content %}
<section class="intro">
  <p class="lead">
    <!-- This is the web interface for <a href="https://github.com/tanghaibao/goatools">Goatools</a> -->
    <!-- which is a set of python command line tools to assist in the analysis of Gene Ontology -->
    <!-- studies. -->
    Group GO IDs using innate DAG hierarchy and researcher-provided sections file.
  </p>
  <div id="form__warning" class="form__error collapse" aria-expanded="false"></div>
</section>
<div class="row">
  <hr class="col-xs-9 col-xs-offset-1">
</div>

<form id="goid-form" action="{% url 'goatoolsgui:index' %}" method="post" enctype="multipart/form-data">
  {% csrf_token %}
  <!--
  GO ID's Input
  -->
  <div id="form__goids-container" class="form-group">
    <!-- TODO: Labeled elsewhere, not sure I can have multiple -->
    <label for="{{ form.goids.id_for_label }}" class="control-label">
      Enter GO id's:
    </label>
    {{ form.gos_file }} <!-- Hidden by '.input-file' in forms.py -->

    <!-- Buttons -->
    <div class="input-group col-xs-12">
      <div class="btn-group">
        <div class="btn-group">
          <button
            class="example-btn btn btn-info btn-sm dropdown-toggle"
            type="button"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false">
              Examples <span class="csaret"></span>
          </button>
          <ul id="example-group" class="dropdown-menu">
            <li id="consistent-decrease"><a href="#">Consistent Decrease</a></li>
            <li id="consistent-increase"><a href="#">Consistent Increase</a></li>
            <li id="late-decrease"><a href="#">Late Decrease</a></li>
            <li id="late-increase"><a href="#">Late Increase</a></li>
            <li id="transient-increase"><a href="#">Transient Increase</a></li>
          </ul>
        </div>
        <label role="button" for="{{ form.gos_file.id_for_label }}" class="btn btn-primary btn-sm">
          Upload
        </label>
      </div>
      <span class="pull-right" data-toggle="tooltip" title="More Information">
        <span id="go-info" data-toggle="collapse" data-target="#goids-help" aria-expanded="false" aria-controls="goids-help">
          <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 19.2 19.2" width="19" height="19" class="info-circle"><path d="M9.6 0C4.3 0 0 4.3 0 9.6c0 5.3 4.3 9.6 9.6 9.6 5.3 0 9.6-4.3 9.6-9.6 0-5.3-4.3-9.6-9.6-9.6zm0.9 3.5c0.9 0 1.2 0.5 1.2 1.2 0 0.8-0.6 1.5-1.7 1.5-0.9 0-1.3-0.4-1.3-1.2 0-0.6 0.5-1.5 1.8-1.5zM8.1 15.4c-0.6 0-1.1-0.4-0.7-2.1L8.2 10.2C8.3 9.7 8.3 9.6 8.2 9.6 8 9.6 7.2 9.9 6.7 10.2L6.3 9.7c1.6-1.3 3.3-2.1 4.1-2.1 0.6 0 0.7 0.8 0.4 1.9l-0.8 3.2c-0.1 0.6-0.1 0.8 0.1 0.8 0.2 0 0.8-0.2 1.4-0.7L11.9 13.3C10.4 14.8 8.7 15.4 8.1 15.4Z"/>
          </svg>
        </span>
        <!-- Entypo pictograms by Daniel Bruce — www.entypo.com -->
      </span>
    </div>
    <!-- The textarea  -->
    {{ form.goids }}
  </div>

  <!--
    GO Id Help Information
  -->
  <section class="panel panel-default collapse" id="goids-help">
    <header class="panel-heading">
      <button class="close" type="button" data-toggle="collapse" data-target="#goids-help" aria-expanded="false" aria-controls="goids-help" aria-label="close">
        <span aria-hidden="true">&times;</span>
      </button>
      <h3 class="panel-title help-text">
        GO Id Information
      </h3>
    </header>
    <div class="panel-body help-text">
      <h4>Manually entering GO Id's</h4>
      <button class="close" type="button" aria-label="close"></button>
      <p>
        If you want to key in the ID's yourself, the format is <code>GO:1234567</code>.
        The list can be either 'comma' or 'space' separated.
      </p>
      <h4>Using a file</h4>
      <p>
        You can save yourself a lot of time by using an existing file. The accepted formats
        are .txt or .tsv files. If you commonly use another format for your GO ID files, send
        an email to support for consideration.
      </p>
      <h4>Example files:</h4>
      <!-- This is ugly but <pre> keeps whitespace, so this is how it is going to be -->
      <figure>
        <figcaption>Each Id on separate line</figcaption>
        <pre class="goid-example">GO:0002376
GO:0002682
GO:0001817
GO:0001816
GO:0034097
GO:0045087
GO:0006954
</pre>
      </figure>
      <figure>
        <figcaption>Space separated Id's</figcaption>
        <pre class="goid-example">GO:0002376 GO:0002682 GO:0001817
GO:0001816 GO:0034097 GO:0045087
GO:0006954 GO:0002521 GO:0002467
GO:0007229 GO:0050900 GO:0022610
GO:0030155 GO:0007155 GO:0016032
GO:0050792 GO:0098542 GO:0009617
GO:0099531 GO:0042391 GO:0050877</pre>
      </figure>
      <figure>
        <figcaption>Comma separated Id's</figcaption>
        <pre class="goid-example">GO:0002376, GO:0002682, GO:0001817,
GO:0001816, GO:0034097, GO:0045087,
GO:0006954, GO:0002521, GO:0002467,
GO:0007229, GO:0050900, GO:0022610,
GO:0030155, GO:0007155, GO:0016032,
GO:0050792, GO:0098542, GO:0009617,
GO:0099531, GO:0042391, GO:0050877</pre>
      </figure>
    </div>
  </section>
  <div class="row">
    <hr class="col-xs-9 col-xs-offset-1">
  </div>

  <!--
  Sections File Input
  -->
  <div class="form-group">
    <!-- TODO: for = ex. {{ form.goids.id_for_label }} -->
    <label for="" class="control-label">
      Add Sections File:
    </label>

    <!-- Hidden by '.input-file' in forms.py -->
    {{ form.sections_file }}
    {{ form.blob_file }}

    <div class="sections-file__group">
      <div class="input-group col-xs-12">

        <!-- Buttons -->
        <div class="btn-group">
          <button id="editor__open-button" type="button" class="btn btn-info btn-sm">
            Generate
          </button>
          <label for="{{ form.sections_file.id_for_label }}" class="btn btn-primary btn-sm">
            Upload
          </label>
        </div>

        <!-- Help Icon -->
        <span  class="pull-right" data-toggle="tooltip" title="More Information">
          <span id="sections-info" data-toggle="collapse" data-target="#sections-help" aria-expanded="false" aria-controls="sections-help">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 19.2 19.2" width="19" height="19" class="info-circle"><path d="M9.6 0C4.3 0 0 4.3 0 9.6c0 5.3 4.3 9.6 9.6 9.6 5.3 0 9.6-4.3 9.6-9.6 0-5.3-4.3-9.6-9.6-9.6zm0.9 3.5c0.9 0 1.2 0.5 1.2 1.2 0 0.8-0.6 1.5-1.7 1.5-0.9 0-1.3-0.4-1.3-1.2 0-0.6 0.5-1.5 1.8-1.5zM8.1 15.4c-0.6 0-1.1-0.4-0.7-2.1L8.2 10.2C8.3 9.7 8.3 9.6 8.2 9.6 8 9.6 7.2 9.9 6.7 10.2L6.3 9.7c1.6-1.3 3.3-2.1 4.1-2.1 0.6 0 0.7 0.8 0.4 1.9l-0.8 3.2c-0.1 0.6-0.1 0.8 0.1 0.8 0.2 0 0.8-0.2 1.4-0.7L11.9 13.3C10.4 14.8 8.7 15.4 8.1 15.4Z"/>
            </svg>
          </span>
          <!-- Entypo pictograms by Daniel Bruce — www.entypo.com -->
        </span>
      </div>

      <!-- File Name -->
      <span id="sections-file-name" class="form-control">Optional</span>
    </div>

    <!--
    Sections File Editor
    -->
    <!--
    <button id="update-dev" class="btn btn-warning" type="button" onclick="resetSections()">
      Dismiss
    </button>
    -->
    <div id="editor__container" class="panel panel-default sections-file__group hidden">
      <div class="editor__header panel-heading">
        <h3 class="panel-title">
        <button class="close" type="button" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <button id="editor__save-changes" class="editor__save-btn btn btn-primary" type="button">
          Save Changes
        </button>
      </h3>
      </div>
      <div class="panel-body">
        <button id="editor__add-section" class="btn btn-info btn-block" type="button">
          Add a New Section
        </button>
        <pre id="editor__file" class="editor">
          <!-- Content is added by addSectionsToPage -->
        </pre>
      </div>
      <!-- DUPLICATED CODE - WHAT TODO ABOUT IT? -->
      <!-- <div class="panel-heading">
        <h3 class="panel-title">
        <button class="close" type="button" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        </h3>
        <button class="editor__save-btn btn btn-primary" type="button">
          Save Changes
        </button>
      </div> -->
    </div>
  </div>
  <!--
    Sections Help Information
  -->
  <section class="panel panel-default collapse" id="sections-help">
    <header class="panel-heading">
      <button class="close" type="button" data-toggle="collapse" data-target="#sections-help" aria-expanded="false" aria-controls="sections-help" aria-label="close">
        <span aria-hidden="true">&times;</span>
      </button>
      <h3 class="panel-title help-text">
        Sections File Information
      </h3>
    </header>
    <div class="panel-body help-text">
      <h4>What is a sections file?</h4>
      <p>
        Here will be information about what exactly a sections file is and
        why you would use one.
      </p>
      <h4>How to make a sections file</h4>
      <p>
        Step by Step instructions on how to make a sections file
      </p>
      <h4>Example File</h4>
      <figure class="section-example">
        <pre># GROUP NAME: compare
# SECTION: immune
GO:0001816 # BP    110 L03 D03 DK    cytokine production
GO:0034097 # BP     59 L04 D04 G     response to cytokine
GO:0050900 # BP     57 L02 D06 CDMN  leukocyte migration
# SECTION: adhesion
GO:0022610 # BP    194 L01 D01 P     biological adhesion
GO:0007155 # BP    165 L02 D02 P     cell adhesion
# SECTION: neuro
GO:0099536 # BP     40 L04 D05 CDR   synaptic signaling
GO:0048666 # BP     29 L04 D05 CDF   neuron development
GO:0022008 # BP      3 L05 D05 CDF   neurogenesis
GO:0007409 # BP     23 L06 D08 CDFI  axonogenesis
# SECTION: lipid
GO:0033993 # BP    108 L04 D04 G     response to lipid
GO:0006869 # BP     93 L04 D05 DH    lipid transport
GO:0055088 # BP     10 L05 D05 A     lipid homeostasis
# SECTION: cell cycle
GO:0022403 # BP     46 L02 D02 S     cell cycle phase
GO:0051301 # BP     54 L03 D03 CD    cell division
GO:0007049 # BP     12 L03 D03 CD    cell cycle
# SECTION: Misc.
GO:0040011 # BP    394 L01 D01 N     locomotion
GO:0007610 # BP    219 L01 D01 O     behavior
GO:0006810 # BP  1,639 L03 D03 H     transport
GO:0007568 # BP     17 L03 D03 DF    aging</pre>
      </figure>
    </div>
  </section>
  <div class="row">
    <hr class="col-xs-9 col-xs-offset-1">
  </div>

  <!--
  Name File Download
  -->
  <div class="form-group">
    <label for="{{ form.filename.id_for_label }}" class="control-label">
      Name file download:
    </label>
    <div id="form__file-download" class="input-group">
      {{ form.filename }}
      <span class="input-group-addon">.xlsx</span>
    </div>
  </div>
  <hr class="col-xs-9 col-xs-offset-1">

  <!--
  Form Buttons
  -->
  <div class="form-group">
    <div class="row">
      <div class="col-xs-5 col-xs-offset-2">
        <input class="btn btn-default" type="reset" />
      </div>
      <div class="col-xs-5">
        <input id="form__submit-btn" class="btn btn-primary" type="submit" />
      </div>
    </div>
  </div>
</form>

<!--
  Plot Image Modal
 -->
<section id="plot-image-modal" class="modal fade" tabindex="-1" role="#"  aria-labeledby="#">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="exampleModalLabel">{Goid}</h4>
      </div>
      <div class="modal-body">
        <!-- Putting the plot image here -->
      </div>
      <div class="modal-footer">
        <p class="text-center">Click to Pan and Zoom</p>
      </div>
    </div>
  </div>
</section>

{% endblock %}
